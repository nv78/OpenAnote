# Enhancing Language Model Accuracy: The Power of a Few Labeled Examples
<a href="https://medium.com/@Liang./enhancing-language-model-accuracy-the-power-of-a-few-labeled-examples-92eae5771323">
  <img src="https://cdn-icons-png.flaticon.com/512/5968/5968906.png" alt="Medium Icon" width="32px">
</a>


**Description:**
As student this project with Anote AI, addressing challenges in Large Language Models (LLMs) like GPT-3.5 Turbo, BERT. In the early days, LLMs required extensive labeled data, posing time and cost challenges. Real-world data complexities, being messy and unstructured, made effective analysis difficult.

To overcome these hurdles, we introduce an active learning approach, enhancing text classification accuracy. Similar to providing students with clear examples for better understanding, the strategy involves fine-tuning models through human feedback or providing more label examples.



## Table of Contents

1. [Installation](#installation)
---

### Accuracy Improvement
After fine-tuning the models with human feedback and additional labeled examples, we observed a consistent improvement in accuracy across different datasets. This result supports the effectiveness of the active learning approach in enhancing the models' understanding of specific domains.

### Finding
After fine-tuning the models with human feedback and additional labeled examples, we observed a consistent improvement in accuracy across different datasets. Notably, our experiments revealed that incorporating targeted training on areas where the model is weak played a pivotal role. This iterative approach allowed the model to gradually enhance its proficiency in handling specific domains.

### Benchmark
<p align="center">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/Amazon%20Dataset/Overall%20Evaluation/Model%20Performance.png" width="700">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/Banking%20Dataset/Overall%20Evaluation/output.png" width="700">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/Craigslist%20Dataset/Overall%20Evaluation/output.png" width="700">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/Finance%20Dataset/Overall%20Evaluation/output.png" width="700">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/TREC%20Dataset/Coarse_Label/Overall%20Evaluation/output.png" width="700">
  <img src="https://github.com/Whiteii/Anote-Text-Classification/blob/main/TREC%20Dataset/Fine_Label/Overall%20Evaluation/output.png" width="700">

  




  

</p>

Banking dataset comprises 77 distinct labels, each denoting a specific inquiry or transaction within the realm of banking. This dataset contains 2000 rows of data. Notably, even with a reduced set of 150 labels, the model continues to exhibit strong performance.


We observed the initial effectiveness of GPT-3.5 Turbo's predictions, demonstrating notable accuracy even without fine-tuning based on feedback, likely due to its pretraining on general knowledge. As we incrementally provided and fine-tuned with 10 labels, extending to 150, we compared its performance against all other implemented models, and GPT-3.5 emerged as the top performer. This highlights that relying solely on a general AI like GPT-3.5 for labeling is not effient.




## Model Performance Comparison

# Amazon Dataset

FT-GPT3.5 Turbo
| # of labels          | 150     | 140     | 130     | 120     | 110     | 100     | 90      | 80      | 70      | 60      | 50      | 40      | 30      | 20      | 10      |
|------------------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| Accuracy         | 63.75%  | 58.50%  | 57.00%  | 64.50%  | 66.25%  | 71.00%  | 64.75%  | 57.50%  | 61.25%  | 61.00%  | 65.00%  | 55.75%  | 52.75%  | 49.00%  | 53.75%  |
| Precision        | 72.56%  | 68.36%  | 69.10%  | 69.02%  | 63.99%  | 67.15%  | 64.03%  | 68.56%  | 69.76%  | 67.66%  | 68.61%  | 42.89%  | 42.62%  | 49.68%  | 41.06%  |
| Recall           | 48.53%  | 44.65%  | 40.32%  | 54.97%  | 47.70%  | 53.23%  | 47.04%  | 43.13%  | 45.52%  | 46.12%  | 52.22%  | 37.71%  | 49.35%  | 38.23%  | 35.02%  |


SETFIT
|# of labels    | 150     | 140     | 130     | 120     | 110     | 100     | 90      | 80      | 70      | 60      | 50      | 40      | 30      | 20      |
|-----------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| Accuracy  | 66.95%  | 68.30%  | 69.95%  | 68.45%  | 69.40%  | 69.20%  | 67.50%  | 68.45%  | 67.05%  | 67.55%  | 67.55%  | 62.95%  | 62.55%  | 58.25%  |
| Precision | 54.30%  | 51.86%  | 54.57%  | 53.91%  | 53.43%  | 54.14%  | 51.10%  | 51.99%  | 54.89%  | 52.42%  | 52.10%  | 49.45%  | 49.84%  | 49.33%  |
| Recall    | 57.28%  | 55.88%  | 57.42%  | 56.46%  | 56.72%  | 54.92%  | 53.20%  | 53.37%  | 56.33%  | 53.65%  | 53.44%  | 51.15%  | 51.26%  | 45.47%  |



BERT
| # of Label    | 150      | 140      | 130      | 120      | 110      | 100      | 90       | 80       | 70       | 60       | 50       | 40       | 30       | 20       | 10       |
|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Accuracy  | 60.75%   | 62.20%   | 63.80%   | 63.45%   | 62.35%   | 61.30%   | 50.95%   | 56.85%   | 49.30%   | 53.45%   | 51.85%   | 18.25%   | 10.05%   | 10.10%   | 10.05%   |
| Precision | 57.52%   | 51.90%   | 49.97%   | 49.02%   | 60.72%   | 41.99%   | 76.16%   | 77.04%   | 71.44%   | 73.71%   | 70.86%   | 56.01%   | 67.00%   | 66.01%   | 64.23%   |
| Recall    | 48.02%   | 44.04%   | 44.40%   | 46.11%   | 38.23%   | 35.63%   | 24.28%   | 28.90%   | 25.13%   | 25.61%   | 24.85%   | 23.75%   | 20.09%   | 20.27%   | 20.17%   |











# Banking Dataset

FT-GPT3.5 Turbo
| # of labels   | 150      | 140      | 130      | 120      | 110      | 100      | 90       | 80       | 70       | 60       | 50       | 40       | 30       | 20       | 10       |
|-----------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| Accuracy  | 77.20%  | 76.80%  | 76.80%  | 75.80%  | 76.90%  | 76.60%  | 76.20%  | 74.00%  | 74.00%  | 72.30%  | 83.00%  | 79.00%  | 75.00%  | 71.00%  | 61.00%  |
| Precision | 73.58%  | 77.06%  | 72.85%  | 75.00%  | 76.82%  | 74.66%  | 78.84%  | 75.29%  | 76.95%  | 71.02%  | 87.10%  | 88.08%  | 79.68%  | 76.97%  | 71.37%  |
| Recall    | 79.27%  | 78.17%  | 79.04%  | 77.21%  | 77.43%  | 77.98%  | 76.71%  | 75.04%  | 74.56%  | 75.03%  | 81.75%  | 79.02%  | 77.44%  | 71.11%  | 63.56%  |



SETFIT
| # of labels | 150                 | 140                 | 130                 | 120                 | 110                 | 100                 | 90                  | 80                  | 70                  | 60                  | 50                  | 40                  | 30                  |
|----------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|---------------------|
| Accuracy | 54.30%              | 52.00%              | 53.10%              | 49.60%              | 47.30%              | 45.15%              | 42.59%              | 37.54%              | 32.93%              | 30.18%              | 26.18%              | 23.32%              | 18.97%              |
| Precision| 55.68%              | 53.38%              | 54.50%              | 50.58%              | 48.69%              | 46.30%              | 44.05%              | 38.92%              | 34.27%              | 31.33%              | 26.91%              | 24.12%              | 19.84%              |
| Recall   | 66.78%              | 67.19%              | 65.72%              | 65.87%              | 67.66%              | 66.87%              | 69.70%              | 68.12%              | 71.22%              | 74.88%              | 75.29%              | 78.30%              | 80.62%              |


 BERT 
| # of labels   | 150      | 140      | 130      | 120      | 110      | 100      | 90       | 80       | 70       | 60       | 50       | 40       | 30       | 20       | 10       |
|-----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Accuracy  | 23.77%   | 19.37%   | 18.72%   | 14.36%   | 9.11%    | 7.76%    | 5.36%    | 4.10%    | 3.45%    | 2.75%    | 1.65%    | 1.80%    | 2.05%    | 1.70%    | 1.65%    |
| Precision | 70.64%   | 72.58%   | 74.28%   | 80.24%   | 83.62%   | 84.66%   | 84.72%   | 85.27%   | 83.80%   | 76.99%   | 77.51%   | 71.72%   | 80.66%   | 82.44%   | 83.26%   |
| Recall    | 23.65%   | 19.25%   | 18.42%   | 14.14%   | 8.90%    | 7.60%    | 5.32%    | 4.11%    | 3.46%    | 2.78%    | 1.67%    | 1.75%    | 1.98%    | 1.55%    | 1.53%    |




# Craigslist Dataset



 FT-GPT3.5 Turbo
| # of labels     | 150    | 140    | 130    | 120    | 110    | 100    | 90     | 80     | 70     | 60     | 50     | 40     | 30     | 20     | 10     |
|-----------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| Accuracy  | 95.70% | 94.70% | 95.30% | 95.30% | 95.10% | 94.80% | 94.00% | 94.90% | 92.80% | 91.10% | 88.90% | 94.20% | 93.20% | 94.10% | 88.20% |
| Precision | 94.68% | 93.61% | 93.64% | 80.94% | 94.09% | 94.01% | 93.36% | 94.06% | 79.26% | 79.15% | 91.28% | 92.67% | 92.44% | 70.08% | 90.46% |
| Recall    | 93.79% | 92.90% | 93.62% | 94.35% | 93.06% | 92.25% | 91.29% | 92.53% | 90.23% | 87.11% | 80.96% | 91.79% | 89.36% | 93.82% | 80.34% |


SETFIT
| # of labels    | 150    | 140    | 130    | 120    | 110    | 100    | 90     | 80     | 70     | 60     | 50     | 40     | 30     | 20     |
|-----------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| Accuracy  | 91.00% | 91.30% | 90.90% | 91.30% | 91.40% | 91.10% | 91.20% | 91.50% | 90.40% | 90.80% | 90.10% | 90.10% | 86.70% | 76.70% |
| Precision | 90.48% | 90.71% | 90.32% | 91.17% | 91.16% | 91.14% | 91.36% | 87.33% | 89.59% | 85.35% | 84.80% | 56.69% | 48.89% | 62.84% |
| Recall    | 89.76% | 89.35% | 89.36% | 90.03% | 89.54% | 90.16% | 88.53% | 68.62% | 60.90% | 50.02% | 30.27% | 28.79% | 23.52% | 19.46% |



BERT
| # of labels     | 150    | 140    | 130    | 120    | 110    | 100    | 90     | 80     | 70     | 60     | 50     | 40     | 30     | 20     | 10     |
|-----------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| Accuracy  | 92.00% | 91.90% | 91.50% | 91.40% | 91.60% | 91.40% | 91.10% | 91.20% | 91.50% | 90.80% | 78.20% | 73.00% | 60.00% | 41.40% | 37.10% |
| Precision | 90.48% | 90.71% | 90.32% | 91.17% | 91.16% | 91.14% | 91.36% | 91.14% | 91.36% | 87.33% | 89.59% | 85.35% | 84.80% | 56.69% | 48.89% |
| Recall    | 89.76% | 89.35% | 89.36% | 90.03% | 89.54% | 90.16% | 88.53% | 88.62% | 88.53% | 68.62% | 60.90% | 50.02% | 30.27% | 28.79% | 23.52% |




# Finance Dataset

 FT-GPT3.5 Turbo
| # of labels     | 150    | 140    | 130    | 120    | 110    | 100    | 90     | 80     | 70     | 60     | 50     | 40     | 30     | 20     | 10     |
|-----------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| Accuracy  | 96.50% | 95.75% | 89.63% | 94.13% | 92.75% | 96.38% | 95.75% | 81.50% | 91.63% | 89.50% | 93.63% | 58.25% | 78.25% | 86.88% | 80.88% |
| Precision | 95.93% | 94.39% | 89.95% | 93.21% | 91.95% | 95.80% | 95.41% | 84.26% | 91.21% | 89.60% | 92.98% | 77.55% | 84.14% | 87.70% | 83.80% |
| Recall    | 97.42% | 97.35% | 93.84% | 96.18% | 95.53% | 97.50% | 96.96% | 89.53% | 94.38% | 93.19% | 95.52% | 56.31% | 80.60% | 90.40% | 68.70% |



SETFIT
| # of labels     | 150    | 140    | 130    | 120    | 110    | 100    | 90     | 80     | 70     | 60     | 50     | 40     | 30     | 20     |
|-----------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| Accuracy  | 91.00% | 91.30% | 90.90% | 91.30% | 91.40% | 91.10% | 91.20% | 91.50% | 90.40% | 90.80% | 90.10% | 90.10% | 86.70% | 76.70% |
| Precision | 89.40% | 89.53% | 88.74% | 89.67% | 89.63% | 89.32% | 89.15% | 88.99% | 88.32% | 89.15% | 88.99% | 88.32% | 83.68% | 73.99% |
| Recall    | 89.78% | 90.02% | 89.91% | 90.39% | 90.17% | 89.71% | 90.30% | 90.14% | 89.34% | 89.32% | 88.65% | 87.66% | 88.33% | 81.52% |


BERT
| # of labels    | 150     | 140     | 130     | 120     | 110     | 100     | 90      | 80      | 70      | 60      | 50      | 40      | 30      | 20      | 10      |
|-----------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|---------|
| Accuracy  | 93.26%  | 93.63%  | 92.13%  | 92.63%  | 91.39%  | 86.64%  | 92.38%  | 90.76%  | 90.14%  | 88.89%  | 89.14%  | 88.14%  | 85.27%  | 61.80%  | 4.37%   |
| Precision | 92.35%  | 92.35%  | 93.47%  | 68.34%  | 67.40%  | 63.78%  | 91.39%  | 66.00%  | 89.99%  | 87.91%  | 89.63%  | 93.58%  | 70.91%  | 60.99%  | 67.01%  |
| Recall    | 49.23%  | 48.42%  | 48.42%  | 62.40%  | 62.40%  | 59.72%  | 61.07%  | 64.02%  | 62.07%  | 55.10%  | 48.97%  | 48.42%  | 43.68%  | 41.67%  | 34.68%  |


# Trec Coarse Label Dataset

 FT-GPT3.5 Turbo
| # of labels  | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    | 10    |
|--------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| Accuracy | 94.6% | 94.2% | 94.8% | 94%   | 93.2% | 94.2% | 94.2% | 92.6% | 90.8% | 89.8% | 92.6% | 83%   | 78.2% | 85.4% | 76%   |
| Precision | 95.8% | 94.5% | 95.1% | 95.4% | 95.2% | 92.1% | 94.9% | 93.5% | 92.1% | 91.4% | 93.4% | 82.5% | 77.5% | 48.4% | 80.5% |
| Recall | 82.8% | 91.4% | 91.8% | 91.4% | 91%   | 90.5% | 91.2% | 89.7% | 88%   | 85.6% | 89.7% | 83.1% | 79.6% | 92.3% | 74.8% |





SETFIT
| # of labels   | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    |
|---------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| Accuracy | 93.6% | 93%   | 93.8% | 92%   | 91.4% | 93.8% | 92.2% | 89%   | 83.8% | 91.2% | 87.4% | 86.8% | 81.2% | 68%   |
| Precision | 89.27% | 88.96% | 89.22% | 87.68% | 87.2% | 89.15% | 91.54% | 88.94% | 80.58% | 90.36% | 84.09% | 83.44% | 70.11% | 61.09% |
| Recall    | 94.51% | 93.62% | 94.65% | 93.31% | 89.93% | 94.5% | 93%   | 90.49% | 86.64% | 92.91% | 89.72% | 87.91% | 85.71% | 77.5% |


BERT
| # of labels | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    | 10    |
|--------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| Accuracy | 89.6% | 91.6% | 86.6% | 90.8% | 85.8% | 81%   | 86.2% | 83.2% | 80.2% | 70.2% | 39.4% | 27%   | 16%   | 26.6% | 22.6% |
| Precision | 92.9% | 91.1% | 90.6% | 93.4% | 82.4% | 77.5% | 84.9% | 86.1% | 86.3% | 81.6% | 74.6% | 78.6% | 71.7% | 75.7% | 87.1% |
| Recall | 83.1% | 86.1% | 76.4% | 78%   | 73.5% | 69.5% | 82.6% | 70.1% | 66.7% | 58.2% | 36.6% | 27.7% | 18.9% | 23.1% |








# Trec Fine Label Dataset

 FT-GPT3.5 Turbo
| # of labels | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    | 10    |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| Accuracy  | 88.00%   | 86.2% | 86.8% | 85.2% | 87%   | 86%   | 82.6% | 80.6% | 82%   | 81.6% | 79.8% | 77%   | 75%   | 74.2% | 67%   |
| Precision | 78.45% | 73.9% | 73.9% | 76.8% | 77.2% | 74.2% | 75.5% | 73.9% | 69.1% | 69.1% | 71.1% | 69.1% | 67.6% | 66.9% | 69.4% |
| Recall    | 81.13% | 79.93% | 79.55% | 75.17% | 78.32% | 76.47% | 73.72% | 70.07% | 68.3% | 70.3% | 69.8% | 67.1% | 67.6% | 68.6% | 51.8% |



SETFIT
| # of labels | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| Accuracy  | 74.4% | 73.2% | 73.2% | 73.2% | 70.2% | 70.8% | 69.2% | 66.0% | 64.4% | 61.0% | 61.4% | 55.4% | 55.6% | 50.4% | 37.8% |
| Precision | 49.30% | 47.28% | 48.14% | 42.62% | 45.41% | 45.90% | 39.97% | 37.75% | 36.16% | 32.42% | 25.71% | 21.04% | 18.23% | 14.93% |
| Recall    | 73.55% | 74.52% | 76.81% | 79.31% | 80.40% | 76.47% | 73.84% | 79.70% | 80.86% | 77.19% | 76.09% | 72.65% | 77.68% | 77.68% |



BERT
| # of labels | 150   | 140   | 130   | 120   | 110   | 100   | 90    | 80    | 70    | 60    | 50    | 40    | 30    | 20    | 10    |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| Accuracy  | 80.8% | 80.6% | 79.2% | 77.2% | 67.6% | 46.8% | 41.2% | 35.8% | 26.0% | 26.4% | 18.8% | 10.6% | 3.6%  | 5.8%  | 4.6%  |
| Precision | 84.96% | 88.3% | 85.4% | 87.6% | 85.6% | 87.3% | 89.1% | 90.4% | 90.4% | 87.2% | 89.5% | 82.8% | 69.4% | 81.3% | 88.3% |
| Recall    | 57.54% | 57.54% | 55.06% | 49.37% | 44.22% | 30.26% | 23.95% | 16.2% | 11.9% | 11.3% | 7.9%  | 5.8%  | 7.8%  | 2.2%  | 2.2%  |























### Confusion Matrix

For a detailed view of the confusion matrix, navigate to the [Overall Evaluation/cm](https://github.com/Whiteii/Anote-Text-Classification/tree/main/Banking%20Dataset/Overall%20Evaluation/CM) for Banking.

For Craigslist, navigate to the [Overall Evaluation/cm](https://github.com/Whiteii/Anote-Text-Classification/tree/main/Craigslist%20Dataset/Overall%20Evaluation/CM).

For TREC, navigate to the [Overall Evaluation/cm](https://github.com/Whiteii/Anote-Text-Classification/tree/main/TREC%20Dataset/Coarse_Label/Overall%20Evaluation/CM).






## Installation

### Prerequisites

Make sure you have Python, pip, and git installed.

### Clone the Repository and Install Dependencies

```bash
git clone https://github.com/Whiteii/Anote-Text-Classification.git
cd Anote-Text-Classification
pip install -r requirements.txt
